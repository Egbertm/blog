---
layout: post
title:  "Hadoop分布式环境下的离散化"
date:   2017-2-28 23:06:05
categories: 大数据
tags:  大数据 Hadoop
---
* content  
{:toc}  

在一般环境对于高维度，连续性变量的离散化，时间性能一直是问题的关键；离散化的效率与数据的维度和数据量的大小都有最直接的关系。为了能够快速的对数据离散，我们采用了分布式环境下的并行计算，实验结果表明可以大幅度的降低数据离散化的时间。  




### Hadoop介绍  
Hadoop是apache基金组织下的一个顶级项目，也是近年来云计算发展的平台支持；已经成为云计算生态系统中一个不可或缺的平台组件。对云计算的发展做出了突出的贡献。Hadoop平台下，主要得益于组件中的HDFS（hadoop 分布式文件系统）,MapReduce计算模型来实现程序的并行计算。  

**HDFS**最早是有google的一篇介绍GFS(google 分布式文件系统)而发展演变过来的，它作为整个云计算平台下的文件存储系统，在该文件存储系统下被存储的文件通常有若干备份，并且对文件进行了block分块存储，通常有一个主服务器管理着整个文件系统，在主服务器中记录了每个文件的一些基本元信息（如，文件块的位置，文件的大小等）。在从服务器上就是具体的存储文件块的内容了。可以提供给分布式程序对文件进行读取，从而实现分布式计算。对文件的读取过程如下图所示：

**MapReduce**是一个分布式计算框架，一般而言开发分布式程序主要也是对MapReduce程序的设计。Map被称为映射函数，通过它能够并行的对文件系统中的文件进行读取，读取后的文件是以键值对的形式存在的，而这个键值对也作为Reduce函数的输入，最后由Reduce函数产生输出文件。  

### 决策表
**决策表**是数据挖掘中用于知识表达的一种有效的工具。它已经在诸如粗糙集等数据挖掘技术中被广泛的应用。下面介绍决策表及其相关概念  
**定义一 **决策表S=(U,R,V,f),其中U是一个非空有限对象集合，U={x1,x2,x3,...xn},xi为一个对象；R是对象的属性集合，分为条件属性C和决策属性D，R=C U D 且C n D = 0；V是属性值的集合V=U va,Va是属性a的值域，f是UXR->V的一个信息函数，表示U中的每个对象在各个属性上的取值。  
**定义二**信息熵是接收的每条消息中包含的信息的平均量，用于度量信息量的大小。  
![http://o886hn2n8.bkt.clouddn.com//suanfa/ID3_2.png](http://o886hn2n8.bkt.clouddn.com//suanfa/ID3_2.png)  

### 分布式离散化过程介绍  

主要有两个过程，第一过程求得离散点；第二过程实现具体的离散。对应于的我们在程序中设计了两个JOB分别对应于以上两个过程。  
1. 第一个JOB的设计如下：Map对预处理之后的数据读取，读取后不同的属性名作为Key,value是该属性的值集合。Reduce函数在得到了这样的一个Key-<value—set>的输入，对于不同的属性可以进行并行处理，最后输出就是的文件就是属性与对应于该属性下计算得到的离散点的集合。  

2. 第二个JOB的设计如下：Map预处理读取第一个JOB产生的离散点的集合，预处理后得到不同属性的离散点的集合，用不同属性的离散点对Map读取的原始文件进行类别标号，Reduce对标号后的文件输出即可。以上是整个Hadoop的执行的过程。  

### 分布式离散化的结果  
实验结果如下：  

| 数据           |     并行计算       | 串行计算  |
| ------------- |:-------------:| -----:|
|    3596条   |   | 5m39s | -----:|

